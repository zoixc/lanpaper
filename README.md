# Lanpaper

–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—è–º–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (JPEG, PNG, GIF, WebP, BMP, TIFF) –∏ –≤–∏–¥–µ–æ (MP4, WebM)
- üîó –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±–æ—è–º
- üñºÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—å—é
- üåê –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ URL –∏–ª–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- üîí Basic Auth –¥–ª—è –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚ö° Rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- üê≥ Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- üéØ –ü—Ä–æ–∫—Å–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp docker-compose-example.yml docker-compose.yml
cp config.example.json config.json
```

2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config.json` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å:
```json
{
  "port": "8080",
  "username": "admin",
  "password": "your_secure_password",
  "maxUploadMB": 50
}
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose up -d
```

4. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080/admin

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞

```bash
go mod download
go build -o lanpaper main.go
./lanpaper
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ß–µ—Ä–µ–∑ config.json

```json
{
  "port": "8080",
  "username": "admin",
  "password": "secret",
  "maxUploadMB": 50,
  "maxImages": 100,
  "max_concurrent_uploads": 3,
  "disableAuth": false,
  "externalImageDir": "external/images",
  "rate": {
    "public_per_min": 50,
    "admin_per_min": 0,
    "upload_per_min": 20,
    "burst": 10
  },
  "proxyType": "http",
  "proxyHost": "",
  "proxyPort": "",
  "proxyUsername": "",
  "proxyPassword": "",
  "insecureSkipVerify": false
}
```

### –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export PORT=8080
export ADMIN_USER=admin
export ADMIN_PASS=secret
export MAX_UPLOAD_MB=50
export MAX_IMAGES=100
export DISABLE_AUTH=false
export RATE_LIMIT=50
export EXTERNAL_IMAGE_DIR=/path/to/images

# Proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
export PROXY_TYPE=http
export PROXY_HOST=proxy.example.com
export PROXY_PORT=8080
export PROXY_USER=username
export PROXY_PASS=password
export INSECURE_SKIP_VERIFY=false
```

## API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ

- `GET /{linkName}` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ/–≤–∏–¥–µ–æ –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Å—ã–ª–∫–µ

### –ê–¥–º–∏–Ω—Å–∫–∏–µ (—Ç—Ä–µ–±—É—é—Ç Basic Auth)

- `GET /admin` - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- `GET /api/wallpapers` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±–æ–µ–≤
- `POST /api/link` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É
  ```json
  {"linkName": "my-wallpaper"}
  ```
- `DELETE /api/link/{linkName}` - –£–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É
- `POST /api/upload` - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  - Form data: `file` (—Ñ–∞–π–ª) –∏–ª–∏ `url` (URL/–ø—É—Ç—å), `linkName`
- `GET /api/external-images` - –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `GET /api/external-image-preview?path=...` - –ü—Ä–µ–≤—å—é –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Å—Å—ã–ª–∫—É

–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É —Å –∏–º–µ–Ω–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä: `sunset`

### 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–π —Å—Å—ã–ª–∫–∏:
- –ß–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
- –ü–æ URL –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –ò–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 3. –ü–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø

–¢–µ–ø–µ—Ä—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://your-server:8080/sunset`

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `maxImages`, —Å—Ç–∞—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏).

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production! –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –ó–∞–ø—É—Å–∫–∞—Ç—å –∑–∞ reverse proxy (nginx/Caddy/Traefik)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limiting –ø–æ–¥ –≤–∞—à—É –Ω–∞–≥—Ä—É–∑–∫—É

## Docker volumes

- `./data` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –æ–±–æ—è—Ö (JSON)
- `./static/images` - –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–≤—å—é
- `./external/images` - –í–Ω–µ—à–Ω—è—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Go 1.21+
- [github.com/nfnt/resize](https://github.com/nfnt/resize) - –†–µ—Å–∞–π–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [github.com/chai2010/webp](https://github.com/chai2010/webp) - WebP –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- [github.com/joho/godotenv](https://github.com/joho/godotenv) - .env —Ñ–∞–π–ª—ã

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ
go run main.go

# –°–±–æ—Ä–∫–∞
go build -o lanpaper main.go

# Docker —Å–±–æ—Ä–∫–∞
docker build -t lanpaper .

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
go test ./...
```

## TODO

- [ ] Unit —Ç–µ—Å—Ç—ã
- [ ] GitHub Actions CI/CD
- [ ] TLS –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ S3/–æ–±–ª–∞—á–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â
- [ ] Bulk –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ API
- [ ] –ü–æ–∏—Å–∫ –ø–æ –æ–±–æ—è–º